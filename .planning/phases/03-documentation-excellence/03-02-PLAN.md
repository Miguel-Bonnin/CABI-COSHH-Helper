---
phase: 03-documentation-excellence
plan: 02
type: execute
depends_on: []
files_modified: [ARCHITECTURE.md]
---

<objective>
Create high-level architecture documentation that explains system design, data flow, and module relationships for developers who need to understand the big picture.

Purpose: Provide architectural context that complements the detailed codebase map - focusing on WHY the system is structured this way and HOW components interact.
Output: ARCHITECTURE.md explaining SPA architecture, data flow, module organization, and future backend vision.
</objective>

<execution_context>
./.claude/get-shit-done/workflows/execute-plan.md
./summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/codebase/ARCHITECTURE.md
@.planning/codebase/STRUCTURE.md
@.planning/codebase/STACK.md
@coshhgeneratorv5.html (first 100 lines to understand structure)
@js/modules/domHelpers.js
@js/modules/riskCalculations.js

**From codebase map:**
- SPA with tab-based workflow (11 tabs)
- LocalStorage for persistence
- PDF.js for MSDS parsing
- JSON export/import
- ChemInventory API integration (admin-only)

**Architecture decisions:**
- No framework (vanilla JS for IT maintainability)
- Modular ES6 architecture (Phase 1-2 refactoring)
- Client-side only (GitHub Pages deployment)
- Future: Backend for auth, workflow, database
</context>

<tasks>

<task type="auto">
  <name>Task 1: Document system architecture and design principles</name>
  <files>ARCHITECTURE.md</files>
  <action>Create ARCHITECTURE.md with sections: (1) System Overview (browser-based SPA, no backend currently, GitHub Pages hosting), (2) Design Principles (no framework for maintainability, modular ES6 architecture, pure functions for testability, progressive enhancement from monolithic HTML), (3) High-Level Architecture diagram using ASCII art or Mermaid showing: User → Browser → [App Components: MSDS Parser, Risk Calculator, Report Generator, Inventory Manager] → LocalStorage + ChemInventory API (admin). (4) Technology Choices explaining why vanilla JS, why Vitest, why happy-dom, why ES6 modules. Include dates when major changes happened (modularization Phase 1 Jan 2026, runtime safety Phase 2 Jan 2026).</action>
  <verify>File exists with 4 sections and clear architectural explanation</verify>
  <done>System overview, principles, architecture diagram, and technology rationale documented</done>
</task>

<task type="auto">
  <name>Task 2: Explain data flow and module relationships</name>
  <files>ARCHITECTURE.md</files>
  <action>Add sections to ARCHITECTURE.md: (5) Data Flow describing the lifecycle: MSDS upload → PDF parsing → form population → risk calculation → control recommendations → report generation → LocalStorage persistence. Show how data flows through masterParsedMSDSData object and DOM form fields. (6) Module Organization explaining: config modules (procedures.js, hazards.js, controls.js) provide static data; utility modules (domHelpers.js, riskCalculations.js) provide pure functions; feature modules (inventory-manager.js, eh40-loader.js, floor-plan-viewer.js) handle specific features; main HTML contains UI and orchestration. Use actual module names from the project.</action>
  <verify>Data flow section traces complete assessment lifecycle; module organization matches actual codebase</verify>
  <done>Data flow and module relationships clearly explained with real examples</done>
</task>

<task type="auto">
  <name>Task 3: Document future architecture vision</name>
  <files>ARCHITECTURE.md</files>
  <action>Add "Future Architecture" section to ARCHITECTURE.md describing the planned backend integration: (1) Current State (frontend-only, LocalStorage, admin scripts for data), (2) Planned Backend (Node.js/Express or similar, database for assessments, user authentication with roles), (3) Workflow Architecture (draft → review → approve → publish to ChemInventory API), (4) Migration Strategy (frontend demonstrates stability and maintainability to gain IT approval, backend adds auth + database without changing frontend UX, API integration replaces admin scripts). Reference PROJECT.md "Ultimate Vision" section. Keep aspirational but realistic tone - this is the goal pending IT approval.</action>
  <verify>Future architecture section exists and aligns with PROJECT.md vision</verify>
  <done>Backend vision documented as logical evolution of current frontend-first approach</done>
</task>

</tasks>

<verification>
Before declaring plan complete:
- [ ] ARCHITECTURE.md exists with all 6+ sections
- [ ] Architecture diagram accurately represents current system
- [ ] Module names match actual files in js/ directory
- [ ] Data flow section is accurate and traceable
- [ ] Future architecture aligns with PROJECT.md goals
- [ ] Document is readable by developers unfamiliar with codebase
</verification>

<success_criteria>

- ARCHITECTURE.md created with system overview and design principles
- Data flow documented from MSDS input to report generation
- Module relationships explained with real examples
- Future backend architecture vision clearly articulated
- Document provides "big picture" context missing from detailed codebase map
</success_criteria>

<output>
After completion, create `.planning/phases/03-documentation-excellence/03-02-SUMMARY.md`:

# Phase 3 Plan 2: ARCHITECTURE.md Summary

**High-level architecture documentation created for system understanding**

## Accomplishments

- Created ARCHITECTURE.md explaining system design and structure
- Documented design principles (vanilla JS, modular ES6, pure functions)
- Provided ASCII/Mermaid architecture diagram of current system
- Explained complete data flow from MSDS to report
- Described module organization with real file examples
- Documented future backend vision aligned with PROJECT.md

## Files Created/Modified

- `ARCHITECTURE.md` - Architecture guide (~200-250 lines)

## Decisions Made

[Document any choices made during implementation, or "None"]

## Issues Encountered

[Document any problems and resolutions, or "None"]

## Next Step

Ready for 03-03-PLAN.md (README.md updates) or continue with remaining Phase 3 plans
</output>
